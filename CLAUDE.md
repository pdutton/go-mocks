# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This repository provides mock implementations for Go standard library interfaces and those from `github.com/pdutton/go-interfaces` using `go.uber.org/mock`. The mocks are auto-generated using `mockgen`.

### General Rules
- Always make changes in a branch, not in master

### Generating Mocks

```bash
# Install mockgen (if not already installed)
make mockgen

# Generate all mocks
make 

# Generate specific package mock
make io/mock_io/all.go
make net/http/client/mock_client/all.go
# ... (see Makefile for all targets)
```

## Architecture

### Directory Structure

The repository mirrors the Go standard library structure with mock implementations:

```
<package>/<subpackage>/mock_<package>/all.go
```

Examples:
- `io/mock_io/all.go` - mocks for io package
- `io/fs/mock_fs/all.go` - mocks for io/fs package
- `net/http/client/mock_client/all.go` - mocks for HTTP client
- `encoding/json/mock_json/all.go` - mocks for JSON encoding

### Mock Generation Pattern

All mocks are generated using the Makefile, which:
1. Sources interfaces from `github.com/pdutton/go-interfaces`
2. Uses `mockgen` to create mock implementations
3. Places generated code in `mock_<package>/all.go` files
4. All generated files are marked with `// Code generated by MockGen. DO NOT EDIT.`

### Adding New Mocks

To add mocks for a new package:

1. Add the target to the `all:` phony target in the Makefile
2. Create a new phony target following the pattern:
   ```makefile
   .PHONY: <path>/mock_<package>/all.go
   <path>/mock_<package>/all.go:
       $(MOCKGEN) -destination $@ -package mock_<package> github.com/pdutton/go-interfaces/<path> Interface1,Interface2,...
   ```
3. Run `make <path>/mock_<package>/all.go` to generate

### Dependencies

- `go.uber.org/mock` - Mock generation framework
- `github.com/pdutton/go-interfaces` - Source interface definitions

## Important Notes

- **Never edit generated files**: All files in `mock_*/all.go` are auto-generated. Changes should be made to the Makefile and regenerated.
- **Version alignment**: When updating `go-interfaces` dependency, regenerate all mocks with `make all`
- The repository uses Go 1.24.0
